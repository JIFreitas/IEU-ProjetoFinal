<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Escape Room - Casa Assombrada</title>

    <!-- CSS do index -->
    <link rel="stylesheet" href="assets/styles/index.css" />

    <!-- Common JS (settings em localStorage) -->
    <script src="assets/scripts/common.js"></script>
  </head>

  <body>
    <div class="settings-icon" onclick="toggleSettings()">
      <span class="icon">⚙️</span>
      <span>CONFIGURAÇÕES</span>
    </div>

    <div
      class="settings-overlay"
      id="settings-overlay"
      onclick="closeSettingsIfOverlay(event)"
    >
      <div class="settings-modal">
        <span class="close-settings" onclick="toggleSettings()">×</span>
        <h3 style="color: #ff6600; margin-bottom: 20px">CONFIGURAÇÕES</h3>

        <div class="setting-item">
          <span>Música Ambiente:</span>
          <div
            class="toggle active"
            id="music-toggle"
            onclick="toggleMusicSetting()"
          >
            <div class="toggle-slider"></div>
          </div>
        </div>

        <div class="setting-item">
          <span>Volume:</span>
          <input
            type="range"
            id="volume-slider"
            min="0"
            max="100"
            value="40"
            oninput="updateVolume(this.value)"
          />
          <span id="volume-value">40%</span>
        </div>
      </div>
    </div>

    <div class="container">
      <h1>ESCAPE ROOM</h1>
      <p>Bem-vindo à Casa Assombrada. Complete os 3 níveis para escapar!</p>

      <div class="info">
        <h3>COMO JOGAR</h3>
        <ul>
          <li><strong>WASD</strong> - Mover</li>
          <li><strong>Mouse</strong> - Olhar ao redor</li>
          <li>
            <strong>Cursor vermelho</strong> - Olhe para objetos brilhantes
          </li>
          <li>
            <strong>Clique automático</strong> - Mantenha cursor sobre objeto
          </li>
          <li><strong>ESC</strong> - Menu de pausa (durante o jogo)</li>
        </ul>
      </div>

      <div class="levels">
        <a href="nivel1-simples.html" class="level-btn">
          NÍVEL 1 - Entrada<br />
          <small style="font-size: 16px">Encontre 3 chaves</small>
        </a>

        <a href="nivel2-simples.html" class="level-btn">
          NÍVEL 2 - Corredor<br />
          <small style="font-size: 16px">Acenda 4 velas na ordem</small>
        </a>

        <a href="nivel3-simples.html" class="level-btn">
          NÍVEL 3 - Sala Final<br />
          <small style="font-size: 16px">Descubra o código secreto</small>
        </a>
      </div>
    </div>

    <script>
      // ===== Aplicar settings guardadas (via common.js) =====
      function syncIndexSettingsUI() {
        const enabled = getMusicEnabled();
        const vol = getMusicVolume();

        document
          .getElementById("music-toggle")
          .classList.toggle("active", enabled);
        document.getElementById("volume-slider").value = String(vol);
        document.getElementById("volume-value").textContent = `${vol}%`;
      }

      // ===== Funções do overlay (UI) =====
      function toggleSettings() {
        document.getElementById("settings-overlay").classList.toggle("active");
      }

      function closeSettingsIfOverlay(event) {
        if (event.target.id === "settings-overlay") toggleSettings();
      }

      // ===== Funções do index que gravam settings (via common.js) =====
      function toggleMusicSetting() {
        setMusicEnabled(!getMusicEnabled());
        syncIndexSettingsUI();
      }

      function updateVolume(value) {
        const v = parseInt(value, 10);
        if (Number.isNaN(v)) return;

        setMusicVolume(v);
        document.getElementById("volume-value").textContent = `${v}%`;
      }

      window.addEventListener("DOMContentLoaded", () => {
        syncIndexSettingsUI();
      });
    </script>
  </body>
</html>
