<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Nível 1 - Encontre 3 Chaves</title>

    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.1/dist/aframe-extras.min.js"></script>

    <link rel="stylesheet" href="../assets/styles/common.css" />

    <!-- Core -->
    <script defer src="../assets/scripts/common.js"></script>
    <script defer src="../assets/scripts/game.js"></script>
  </head>

  <body>
    <div id="hud">
      <div>Chaves: <span id="keys">0</span>/3</div>
      <div id="msg">Encontra 3 chaves para abrir a porta!</div>
      <div class="hud-hint">Pressione ESC para pausar</div>
    </div>

    <div id="timer-top" class="timer-top" aria-label="Tempo restante">
      <span id="timer-text">00:00</span>
    </div>

    <div id="pause-menu" class="theme-red">
      <h2>JOGO PAUSADO</h2>

      <div class="setting-row">
        <span>Música:</span>
        <div
          class="toggle active"
          id="music-toggle"
          onclick="togglePauseMusic()"
        >
          <div class="toggle-slider"></div>
        </div>
      </div>

      <div class="setting-row">
        <span>Volume:</span>
        <input
          type="range"
          min="0"
          max="100"
          value="40"
          id="volume-control"
          oninput="updatePauseVolume(this.value)"
        />
        <span id="vol-display">40%</span>
      </div>

      <button class="menu-btn btn-red" onclick="resumeGame()">Continuar</button>
      <button
        class="menu-btn btn-red"
        onclick="window.location.href='../index-simples.html'"
      >
        Menu Principal
      </button>
    </div>

    <a-scene fog="type: exponential; color: #0a0502; density: 0.03">
      <a-assets>
        <!-- Futuro: texturas / modelos -->
        <!-- <img id="woodTexture" src="../assets/textures/wood_dark.jpg" /> -->
      </a-assets>

      <a-sky color="#111"></a-sky>

      <!-- Chão com nav-mesh -->
      <a-plane
        position="0 0 0"
        rotation="-90 0 0"
        width="13.7"
        height="13.7"
        color="#2a1810"
        nav-mesh
      ></a-plane>

      <!-- Paredes -->
      <a-box
        position="0 2 -7"
        width="15"
        height="4"
        depth="0.2"
        color="#4a3020"
      ></a-box>
      <a-box
        position="-7 2 0"
        width="0.2"
        height="4"
        depth="15"
        color="#4a3020"
      ></a-box>
      <a-box
        position="7 2 0"
        width="0.2"
        height="4"
        depth="15"
        color="#4a3020"
      ></a-box>
      <a-box
        position="0 2 7"
        width="15"
        height="4"
        depth="0.2"
        color="#4a3020"
      ></a-box>

      <!-- Teto -->
      <a-plane
        position="0 4 0"
        rotation="90 0 0"
        width="15"
        height="15"
        color="#1a1410"
      ></a-plane>

      <!-- ===== CHAVES ESCONDIDAS (invisíveis) ===== -->
      <a-entity
        id="key1"
        class="key"
        position="-3 0.75 -2.35"
        visible="false"
        geometry="primitive: cylinder; radius: 0.05; height: 0.35"
        material="color: #d4af37; metalness: 0.8; roughness: 0.2"
        rotation="0 0 90"
      ></a-entity>

      <a-entity
        id="key2"
        class="key"
        position="2 1.05 -2.9"
        visible="false"
        geometry="primitive: cylinder; radius: 0.05; height: 0.35"
        material="color: #d4af37; metalness: 0.8; roughness: 0.2"
        rotation="0 0 90"
      ></a-entity>

      <a-entity
        id="key3"
        class="key"
        position="0 1.55 -5.6"
        visible="false"
        geometry="primitive: cylinder; radius: 0.05; height: 0.35"
        material="color: #d4af37; metalness: 0.8; roughness: 0.2"
        rotation="0 0 90"
      ></a-entity>

      <!-- ===== ESCONDERIJO 1: CÓMODA + GAVETA ===== -->
      <a-box
        id="dresser"
        position="-3 0.6 -3"
        width="1.6"
        height="1.2"
        depth="0.6"
        color="#3b2a1a"
      ></a-box>

      <a-box
        id="drawer1"
        class="drawer"
        position="-3 0.55 -2.72"
        width="1.3"
        height="0.35"
        depth="0.18"
        color="#2a1a10"
      ></a-box>

      <!-- ===== ESCONDERIJO 2: MESA + CAIXA ===== -->
      <a-box
        position="2 0.45 -3"
        width="1.8"
        height="0.1"
        depth="1.2"
        color="#2f241b"
      ></a-box>

      <a-box
        position="1.3 0.2 -2.5"
        width="0.1"
        height="0.4"
        depth="0.1"
        color="#2f241b"
      ></a-box>
      <a-box
        position="2.7 0.2 -2.5"
        width="0.1"
        height="0.4"
        depth="0.1"
        color="#2f241b"
      ></a-box>
      <a-box
        position="1.3 0.2 -3.5"
        width="0.1"
        height="0.4"
        depth="0.1"
        color="#2f241b"
      ></a-box>
      <a-box
        position="2.7 0.2 -3.5"
        width="0.1"
        height="0.4"
        depth="0.1"
        color="#2f241b"
      ></a-box>

      <a-box
        id="boxBase"
        position="2 0.65 -3"
        width="0.6"
        height="0.25"
        depth="0.6"
        color="#1a1a1a"
      ></a-box>

      <a-box
        id="boxLid"
        class="boxlid"
        position="2 0.8 -3"
        width="0.62"
        height="0.05"
        depth="0.62"
        color="#333333"
      ></a-box>

      <!-- ===== ESCONDERIJO 3: QUADRO ===== -->
      <a-box
        id="picture1"
        class="picture"
        position="0 2 -6.85"
        width="1.4"
        height="0.9"
        depth="0.05"
        color="#111111"
      ></a-box>

      <a-box
        position="0 2 -6.84"
        width="1.5"
        height="1.0"
        depth="0.03"
        color="#5a3b22"
      ></a-box>

      <!-- ===== Porta ===== -->
      <a-box
        id="door"
        position="0 2 -6.9"
        width="2"
        height="3"
        depth="0.1"
        color="#663300"
      ></a-box>

      <a-text
        id="door-text"
        value="PORTA TRANCADA"
        position="0 3.5 -6.8"
        align="center"
        color="#ff0000"
        width="5"
      ></a-text>

      <!-- ===== Luz (mais realista) ===== -->
      <a-light type="ambient" intensity="0.15"></a-light>
      <a-light
        type="point"
        position="0 3 0"
        intensity="0.9"
        color="#ffbb88"
        distance="12"
      ></a-light>

      <!-- ===== Rig ===== -->
      <a-entity
        id="rig"
        position="0 0 5"
        clamp-bounds="minX: -6.85; maxX: 6.85; minZ: -6.85; maxZ: 6.85; margin: 0.05"
        movement-controls="speed: 0.3; fly: false; constrainToNavMesh: true"
      >
        <a-camera
          position="0 1.6 0"
          wasd-controls="enabled: false"
          look-controls="pointerLockEnabled: false"
        >
          <a-cursor
            color="#ff0000"
            fuse="true"
            fuse-timeout="800"
            raycaster="objects: .key, #door, .drawer, .boxlid, .picture"
          ></a-cursor>
        </a-camera>
      </a-entity>
    </a-scene>

    <audio id="bg-music" loop preload="auto">
      <source src="../assets/sounds/musica-ambiente.mp3" type="audio/mpeg" />
    </audio>

    <!-- Script do nível -->
    <script src="../assets/scripts/levels/level1.js"></script>
  </body>
</html>
