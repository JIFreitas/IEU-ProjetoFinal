<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Nível 2 - Acenda 4 Velas</title>

    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.1/dist/aframe-extras.min.js"></script>

    <link rel="stylesheet" href="../assets/styles/common.css" />

    <!-- Core -->
    <script defer src="../assets/scripts/common.js"></script>
    <script defer src="../assets/scripts/game.js"></script>
  </head>

  <body>
    <div id="hud">
      <div>Velas: <span id="candles">0</span>/4</div>
      <div id="msg">Procura o isqueiro e segue a pista do quadro.</div>
      <div class="hud-hint">Pressione ESC para pausar</div>
    </div>

    <div id="timer-top" class="timer-top" aria-label="Tempo restante">
      <span id="timer-text">00:00</span>
    </div>

    <div id="pause-menu" class="theme-orange">
      <h2>JOGO PAUSADO</h2>

      <div class="setting-row">
        <span>Música:</span>
        <div
          class="toggle active"
          id="music-toggle"
          onclick="togglePauseMusic()"
        >
          <div class="toggle-slider"></div>
        </div>
      </div>

      <div class="setting-row">
        <span>Volume:</span>
        <input
          type="range"
          min="0"
          max="100"
          value="40"
          id="volume-control"
          oninput="updatePauseVolume(this.value)"
        />
        <span id="vol-display">40%</span>
      </div>

      <button class="menu-btn btn-orange" onclick="resumeGame()">
        Continuar
      </button>
      <button
        class="menu-btn btn-orange"
        onclick="window.location.href='../index-simples.html'"
      >
        Menu Principal
      </button>
    </div>

    <a-scene>
      <a-sky color="#050505"></a-sky>

      <!-- Chão -->
      <a-plane
        position="0 0 -5"
        rotation="-90 0 0"
        width="4"
        height="19.6"
        color="#1a1410"
        nav-mesh
      ></a-plane>

      <!-- Paredes corredor -->
      <a-box
        position="-2.5 2 -5"
        width="0.2"
        height="4"
        depth="20"
        color="#3a2510"
      ></a-box>
      <a-box
        position="2.5 2 -5"
        width="0.2"
        height="4"
        depth="20"
        color="#3a2510"
      ></a-box>
      <a-box
        position="0 2 5"
        width="6"
        height="4"
        depth="0.2"
        color="#3a2510"
      ></a-box>
      <a-box
        position="0 2 -15"
        width="6"
        height="4"
        depth="0.2"
        color="#3a2510"
      ></a-box>

      <!-- Teto -->
      <a-plane
        position="0 4 -5"
        rotation="90 0 0"
        width="6"
        height="20"
        color="#0a0a0a"
      ></a-plane>

      <!-- QUADRO (clicável) -->
      <a-entity
        id="order-board"
        class="interactable"
        position="2.35 2.2 -9"
        rotation="0 -90 0"
      >
        <a-plane
          class="interactable"
          width="4.5"
          height="1.5"
          color="#2b1b10"
        ></a-plane>

        <a-text
          class="interactable"
          value="ORDEM DOS ELEMENTOS"
          position="0 0.35 0.01"
          align="center"
          color="#d8c7a6"
          width="6"
        ></a-text>

        <!-- Texto escondido (aparece ao clicar) -->
        <a-text
          id="order-text"
          value="2 → 4 → 1 → 3"
          visible="false"
          position="0 -0.25 0.01"
          align="center"
          color="#ffffaa"
          width="6"
        ></a-text>
      </a-entity>

      <!-- ISQUEIRO (clicável) -->
      <a-box
        id="lighter"
        class="interactable"
        position="0 0.6 -2"
        width="0.25"
        height="0.08"
        depth="0.12"
        color="#cfcfcf"
        animation="property: rotation; to: 0 360 0; loop: true; dur: 3500"
      ></a-box>
      <a-text
        value="?"
        position="0 0.9 -2"
        align="center"
        color="#ffffff"
        width="3"
      ></a-text>

      <!-- Velas -->
      <a-entity position="-1 1.5 -8">
        <a-cylinder
          id="candle1"
          class="candle interactable"
          radius="0.1"
          height="0.5"
          color="#8b4513"
          data-order="1"
        ></a-cylinder>
        <a-text
          value="1"
          position="0 0.8 0"
          align="center"
          color="#ffffff"
          width="3"
        ></a-text>
        <a-sphere
          id="flame1"
          visible="false"
          position="0 0.4 0"
          radius="0.15"
          color="#ff6600"
          animation="property: scale; from: 1 1 1; to: 1.2 1.2 1.2; dir: alternate; loop: true; dur: 300"
        ></a-sphere>
      </a-entity>

      <a-entity position="1 1.5 -8">
        <a-cylinder
          id="candle2"
          class="candle interactable"
          radius="0.1"
          height="0.5"
          color="#8b4513"
          data-order="2"
        ></a-cylinder>
        <a-text
          value="2"
          position="0 0.8 0"
          align="center"
          color="#ffffff"
          width="3"
        ></a-text>
        <a-sphere
          id="flame2"
          visible="false"
          position="0 0.4 0"
          radius="0.15"
          color="#ff6600"
          animation="property: scale; from: 1 1 1; to: 1.2 1.2 1.2; dir: alternate; loop: true; dur: 300"
        ></a-sphere>
      </a-entity>

      <a-entity position="-1 1.5 -12">
        <a-cylinder
          id="candle3"
          class="candle interactable"
          radius="0.1"
          height="0.5"
          color="#8b4513"
          data-order="3"
        ></a-cylinder>
        <a-text
          value="3"
          position="0 0.8 0"
          align="center"
          color="#ffffff"
          width="3"
        ></a-text>
        <a-sphere
          id="flame3"
          visible="false"
          position="0 0.4 0"
          radius="0.15"
          color="#ff6600"
          animation="property: scale; from: 1 1 1; to: 1.2 1.2 1.2; dir: alternate; loop: true; dur: 300"
        ></a-sphere>
      </a-entity>

      <a-entity position="1 1.5 -12">
        <a-cylinder
          id="candle4"
          class="candle interactable"
          radius="0.1"
          height="0.5"
          color="#8b4513"
          data-order="4"
        ></a-cylinder>
        <a-text
          value="4"
          position="0 0.8 0"
          align="center"
          color="#ffffff"
          width="3"
        ></a-text>
        <a-sphere
          id="flame4"
          visible="false"
          position="0 0.4 0"
          radius="0.15"
          color="#ff6600"
          animation="property: scale; from: 1 1 1; to: 1.2 1.2 1.2; dir: alternate; loop: true; dur: 300"
        ></a-sphere>
      </a-entity>

      <!-- Porta -->
      <a-box
        id="door"
        class="interactable"
        position="0 2 -15"
        width="2"
        height="3"
        depth="0.1"
        color="#663300"
      ></a-box>

      <!-- Luz -->
      <a-light type="ambient" intensity="0.2"></a-light>
      <a-light
        type="point"
        position="0 3 -8"
        intensity="0.5"
        color="#ffaa66"
      ></a-light>

      <!-- Rig -->
      <a-entity
        id="rig"
        position="0 0 2"
        clamp-bounds="minX: -2.3; maxX: 2.3; minZ: -14.8; maxZ: 4.8; margin: 0.05"
        movement-controls="speed: 0.3; fly: false; constrainToNavMesh: true"
      >
        <a-camera
          position="0 1.6 0"
          wasd-controls="enabled: false"
          look-controls="pointerLockEnabled: false"
        >
          <a-cursor
            color="#ff0000"
            fuse="true"
            fuse-timeout="800"
            raycaster="objects: .interactable"
          ></a-cursor>
        </a-camera>
      </a-entity>
    </a-scene>

    <audio id="bg-music" loop preload="auto">
      <source src="../assets/sounds/musica-ambiente.mp3" type="audio/mpeg" />
    </audio>

    <!-- Script do nível -->
    <script src="../assets/scripts/levels/level2.js"></script>
  </body>
</html>
