<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Nível 3 - Descubra o Código</title>

    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.1/dist/aframe-extras.min.js"></script>

    <link rel="stylesheet" href="../assets/styles/common.css" />

    <!-- Core -->
    <script defer src="../assets/scripts/common.js"></script>
    <script defer src="../assets/scripts/game.js"></script>

    <!-- UI do input -->
    <style>
      #code-input {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.95);
        padding: 26px 28px;
        border-radius: 14px;
        text-align: center;
        display: none;
        z-index: 2000;
        border: 2px solid rgba(0, 255, 0, 0.35);
      }
      #code-input input {
        font-size: 34px;
        width: 220px;
        text-align: center;
        padding: 10px;
        letter-spacing: 10px;
        border: 2px solid #00ff00;
        background: #000;
        color: #00ff00;
        outline: none;
        border-radius: 8px;
      }
      #code-input button {
        font-size: 20px;
        padding: 10px 26px;
        margin-top: 14px;
        background: #00ff00;
        border: none;
        cursor: pointer;
        border-radius: 8px;
      }
    </style>
  </head>

  <body>
    <div id="hud">
      <div>Pistas: <span id="clues">0</span>/4</div>
      <div id="msg">Encontra 4 pistas para descobrir o código do terminal.</div>
      <div class="hud-hint">Pressione ESC para pausar</div>
    </div>

    <div id="timer-top" class="timer-top" aria-label="Tempo restante">
      <span id="timer-text">00:00</span>
    </div>

    <div id="pause-menu" class="theme-green">
      <h2>JOGO PAUSADO</h2>

      <div class="setting-row">
        <span>Música:</span>
        <div
          class="toggle active"
          id="music-toggle"
          onclick="togglePauseMusic()"
        >
          <div class="toggle-slider"></div>
        </div>
      </div>

      <div class="setting-row">
        <span>Volume:</span>
        <input
          type="range"
          min="0"
          max="100"
          value="40"
          id="volume-control"
          oninput="updatePauseVolume(this.value)"
        />
        <span id="vol-display">40%</span>
      </div>

      <button class="menu-btn btn-green" onclick="resumeGame()">
        Continuar
      </button>
      <button
        class="menu-btn btn-green"
        onclick="window.location.href='../index-simples.html'"
      >
        Menu Principal
      </button>
    </div>

    <!-- Painel do terminal -->
    <div id="code-input">
      <h2 style="color: #00ff00; margin: 0 0 12px 0">Código (4 dígitos)</h2>
      <input type="text" id="code" maxlength="4" placeholder="____" />
      <br />
      <button onclick="checkCode()">Confirmar</button>
      <div id="code-msg" style="margin-top: 12px; color: white"></div>
    </div>

    <a-scene>
      <a-sky color="#000"></a-sky>

      <!-- Chão -->
      <a-plane
        position="0 0 0"
        rotation="-90 0 0"
        width="11"
        height="11"
        color="#0a0a0a"
        nav-mesh
      ></a-plane>

      <!-- Paredes -->
      <a-box
        position="0 2 -6"
        width="12"
        height="4"
        depth="0.2"
        color="#1a1a1a"
      ></a-box>
      <a-box
        position="-6 2 0"
        width="0.2"
        height="4"
        depth="12"
        color="#1a1a1a"
      ></a-box>
      <a-box
        position="6 2 0"
        width="0.2"
        height="4"
        depth="12"
        color="#1a1a1a"
      ></a-box>
      <a-box
        position="0 2 6"
        width="12"
        height="4"
        depth="0.2"
        color="#1a1a1a"
      ></a-box>

      <!-- Pistas estilo "papel" (clicáveis) -->
      <!-- 1º dígito: 3 -->
      <a-entity
        class="clue interactable"
        data-pos="1"
        data-digit="3"
        position="-5.7 2.2 -2"
        rotation="0 90 0"
      >
        <a-plane
          class="interactable"
          width="1.2"
          height="0.7"
          color="#2a2a2a"
        ></a-plane>
        <a-text
          value="Pista"
          position="0 0.05 0.01"
          align="center"
          color="#ffffff"
          width="3"
        ></a-text>
      </a-entity>

      <!-- 2º dígito: 7 -->
      <a-entity
        class="clue interactable"
        data-pos="2"
        data-digit="7"
        position="5.7 2.2 -2"
        rotation="0 -90 0"
      >
        <a-plane
          class="interactable"
          width="1.2"
          height="0.7"
          color="#2a2a2a"
        ></a-plane>
        <a-text
          value="Pista"
          position="0 0.05 0.01"
          align="center"
          color="#ffffff"
          width="3"
        ></a-text>
      </a-entity>

      <!-- 3º dígito: 1 -->
      <a-entity
        class="clue interactable"
        data-pos="3"
        data-digit="1"
        position="-2 1.8 5.7"
        rotation="0 180 0"
      >
        <a-plane
          class="interactable"
          width="1.2"
          height="0.7"
          color="#2a2a2a"
        ></a-plane>
        <a-text
          value="Pista"
          position="0 0.05 0.01"
          align="center"
          color="#ffffff"
          width="3"
        ></a-text>
      </a-entity>

      <!-- 4º dígito: 9 -->
      <a-entity
        class="clue interactable"
        data-pos="4"
        data-digit="9"
        position="2 1.8 5.7"
        rotation="0 180 0"
      >
        <a-plane
          class="interactable"
          width="1.2"
          height="0.7"
          color="#2a2a2a"
        ></a-plane>
        <a-text
          value="Pista"
          position="0 0.05 0.01"
          align="center"
          color="#ffffff"
          width="3"
        ></a-text>
      </a-entity>

      <!-- Terminal (mostra slots) -->
      <a-box
        id="terminal"
        class="interactable"
        position="0 1.5 0"
        width="1.2"
        height="1.6"
        depth="0.35"
        color="#2b2b2b"
      >
        <a-text
          id="terminal-status-text"
          value="TERMINAL\n[TRANCADO]"
          position="0 0.35 0.19"
          align="center"
          color="#00ff00"
          width="2.2"
        ></a-text>

        <a-text
          id="terminal-slots-text"
          value="_ _ _ _"
          position="0 -0.25 0.19"
          align="center"
          color="#ffffff"
          width="3"
        ></a-text>
      </a-box>

      <!-- Luz -->
      <a-light type="ambient" intensity="0.4"></a-light>
      <a-light
        type="point"
        position="0 3.5 0"
        intensity="1"
        color="#ffffff"
      ></a-light>

      <!-- Rig -->
      <a-entity
        id="rig"
        position="0 0 5"
        clamp-bounds="minX: -5.8; maxX: 5.8; minZ: -5.8; maxZ: 5.8; margin: 0.05"
        movement-controls="speed: 0.3; fly: false; constrainToNavMesh: true"
      >
        <a-camera
          position="0 1.6 0"
          wasd-controls="enabled: false"
          look-controls="pointerLockEnabled: false"
        >
          <a-cursor
            color="#00ff00"
            fuse="true"
            fuse-timeout="800"
            raycaster="objects: .interactable"
          ></a-cursor>
        </a-camera>
      </a-entity>
    </a-scene>

    <audio id="bg-music" loop preload="auto">
      <source src="../assets/sounds/musica-ambiente.mp3" type="audio/mpeg" />
    </audio>

    <!-- Script do nível -->
    <script src="../assets/scripts/levels/level3.js"></script>
  </body>
</html>
